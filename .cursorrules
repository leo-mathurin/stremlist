You are an expert in JavaScript, Node.js, Express, and Stremio Addon development.

Key Principles

- Write concise, maintainable JavaScript code with the less code the better approach.
- Always read Stremio SDK and addon documentation before implementing related features.
- Do not implement more than purely necessary to achieve the task.
- Prefer clear, explicit code over clever solutions.
- Use descriptive variable names (e.g., isActive, hasPagination).
- Follow standard JavaScript project structure and naming conventions.
- Apply DRY (Don't Repeat Yourself) principles.

JavaScript Code Style

- Follow the project's established code style conventions.
- Use ES6+ features when appropriate (arrow functions, destructuring, etc.).
- Prefer async/await over callbacks and Promise chains.
- Document code with clear JSDoc comments.
- Organize imports logically: standard library, third-party, local.
- Use template literals for string formatting.
- Write unit tests for critical functionality.

Error Handling and Validation

- Prioritize error handling and edge cases:
  - Handle network errors and site availability issues gracefully.
  - Use try/catch blocks for expected exceptions during API calls and scraping.
  - Implement timeouts for web requests to prevent hanging.
  - Log errors with relevant context for debugging.
  - Use early returns for error conditions to avoid deeply nested if statements.
  - Implement proper error logging with appropriate detail levels.
  - Include fallback mechanisms for critical operations.

IMDb Watchlist Integration

- Handle IMDb API changes gracefully, with fallback mechanisms.
- Use appropriate user-agent strings for requests to avoid blocking.
- Structure extractors to be modular and reusable.
- Balance between comprehensive data extraction and performance.
- Validate extracted data before processing or storing.
- Handle private vs. public watchlist distinctions clearly.

Stremio Addon Development

- Follow Stremio addon specification for manifest and catalog structure.
- Implement proper caching mechanisms to improve performance.
- Use consistent ID formats for movies and TV shows.
- Handle Stremio's stream and meta requests efficiently.
- Implement proper error handling for addon endpoints.
- Consider user experience in addon configuration and catalog design.

Redis and Background Processing

- Use Redis for efficient caching and background job processing.
- Implement proper error handling for Redis operations.
- Use Bull queue for reliable background job processing.
- Validate and sanitize all user input before storage.
- Implement proper cleanup mechanisms to prevent memory leaks.

Testing and Debugging

- Write tests for critical components: API endpoints, data processing, caching.
- Use test fixtures to simulate API responses when possible.
- Implement logging at appropriate levels for debugging and auditing.
- Build monitoring for background jobs and synchronization processes.
- Create simple validation checks for extracted data.

Performance Considerations

- Implement efficient caching mechanisms to reduce API calls to IMDb.
- Consider batch processing for large watchlists.
- Monitor and optimize memory usage for many concurrent users.
- Use async patterns for I/O-bound operations like network requests.
- Implement rate limiting to prevent service abuse.

Python Development

- Write clean, readable Python code following PEP 8 style guidelines.
- Use `uv` for virtual environment creation and management.
- Never hardcode package versions - use `pip freeze` to generate requirements.txt.
- Prefer pathlib over os.path for file system operations.
- Use type hints for function parameters and return values.
- Follow Python naming conventions (snake_case for functions/variables).
- Use list/dict comprehensions when they improve readability.
- Document functions and classes with proper docstrings.

Python Environment Management

- Create virtual environments using `uv venv` for isolation.
- Install packages with `uv pip install` or standard pip within the venv.
- Generate requirements.txt using `pip freeze > requirements.txt`.
- Keep requirements.txt updated and version-controlled.
- Use separate requirements files for development dependencies if needed.
- Document Python version requirements in README or setup files.

Python Error Handling and Validation

- Use try/except blocks for expected exceptions.
- Be specific with exception types rather than catching all exceptions.
- Log errors with appropriate context and stack traces.
- Validate input data early and fail fast on invalid inputs.
- Use custom exception classes for domain-specific errors.
- Handle external API failures gracefully with retries and fallbacks.
- Implement proper timeout handling for network requests.

Python Integration with Node.js Project

- Structure Python scripts in logical directories (e.g., scripts/, utils/).
- Use JSON for data exchange between Python and Node.js components.
- Implement proper exit codes for Python scripts called from Node.js.
- Handle subprocess communication errors in Node.js when calling Python.
- Use environment variables for configuration shared between languages.
- Document Python script interfaces and expected inputs/outputs.

Python Testing and Quality

- Write unit tests using pytest for critical Python components.
- Use fixtures for test data and mocking external dependencies.
- Implement proper test coverage for error scenarios.
- Use linting tools (flake8, pylint) for code quality checks.
- Format code with black or similar formatters.
- Validate data processing and transformation logic thoroughly.

Deployment and Infrastructure

- Server runs on Oracle VPS with self-maintained infrastructure.
- Use Cloudflare DNS for domain management and CDN services.
- Leverage Docker for containerized deployment and environment consistency.
- Implement bash scripts for automation, deployment, and maintenance tasks.
- Consider Oracle VPS limitations and optimize for available resources.
- Design deployment scripts to handle service updates and rollbacks.
- Monitor server health and implement proper logging for production issues.
- Use Docker Compose for multi-service orchestration in production.
- Include Python runtime and dependencies in Docker images when needed.

Documentation

- Document setup and configuration requirements.
- Include examples of how to use the addon.
- Document known limitations and edge cases.
- Keep a changelog of major changes and improvements. 